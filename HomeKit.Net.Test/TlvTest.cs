using HomeKit.Net;
using Org.BouncyCastle.Math;

namespace HomeKit.NetTest;

public class TlvTest
{
    [Fact]
    public void TvlEncode()
    {
        var d = new BigInteger("1442420008424254955745650205273851113437877475014685091969330183377879758053627053475115436842672544714359349007302356051554885354223369222242653232239686541495183108696370129543473142572417944486985524741218928952544427243376336763386693026661231043402414832638500755868107483407214024254264535699594318590271395048495294673384691367311331342853354931776709581573259075980599911899671294056313493181747416394000503064997135843031424233381502091813078360948497362948201591528705598998533132323294624870655677296337710538065378656439484182189052555162328452220072117172789588120129559215256311508517451392921876980113781316326176417527240869977996355785823905403456379196159385973773721520837966427815762696346247998558056032313683749505888523700398715604910018284515901439847073556235965668817953456710430328245577631604206448986956080297908082125100383010798803033594854942139435430674664818784952522105880182458069253109230");
        
        var tlvParams = new List<TlvItem>();
        tlvParams.Add(new TlvItem(new byte[]{6},new byte[]{2}));
        tlvParams.Add(new TlvItem(new byte[]{3},d.ToByteArrayUnsigned()));
        var c= new Tlv().Encode(tlvParams);
        var rrrr =
            "'6,1,2,3,255,63,143,103,11,253,24,176,64,39,248,34,56,209,18,1,89,141,37,166,53,67,82,212,90,136,147,118,159,159,213,90,212,111,130,144,79,197,7,134,98,71,122,122,67,247,55,96,232,167,139,178,237,197,185,162,138,200,239,45,10,147,146,121,139,151,52,179,69,228,58,249,128,117,108,36,128,66,240,219,214,234,236,223,94,99,66,112,136,2,190,124,31,45,217,108,18,218,35,187,192,178,120,154,113,198,46,224,41,61,175,113,36,113,69,38,119,136,137,47,11,233,234,146,19,172,124,251,103,197,183,146,247,116,185,162,99,41,253,209,188,122,37,67,137,226,56,10,106,148,105,103,134,105,107,87,159,225,184,163,155,9,80,202,250,239,160,184,216,27,172,207,119,86,203,31,248,171,41,183,116,153,184,177,206,184,200,45,156,132,145,159,250,155,32,184,207,144,207,194,45,65,149,120,248,49,227,59,105,155,103,117,168,16,76,233,139,59,118,73,249,70,133,238,164,66,109,12,34,89,166,8,134,225,99,6,41,181,42,247,88,174,223,104,159,71,55,45,240,225,44,9,76,169,176,72,3,129,216,126,67,147,53,7,207,10,98,88,241,149,242,85,43,211,86,117,3,34,130,49,230,48,230,178,15,10,51,75,99,23,199,187,231,212,252,12,155,254,102,205,248,2,191,248,200,224,174,146,155,91,202,16,122,24,78,192,80,13,134,186,117,199,211,47,14,115,60,7,212,189,185,85,120,136,206,62,38,128,33,252,123,170,41,5,253,231,136,12,171,1,119,228,169,196,34,125,11,154,180,255,2,124,33,238,152,76,41,92,104,94,84,23,184,115,221,1,131,92,163,27,236,241,62,117,156,53,238'";

        rrrr = rrrr.Replace("'", "");
        
        var f1 = rrrr.Split(",").ToList();
        for (var i = 0; i < f1.Count; i++)
        {
            var f2 = f1[i];
            var f21 = c[i].ToString();
            if (f2 != f21)
            {
                var ccccc = 123;
            }
        }

        var cSum= string.Join(",", c);
        Assert.Equal(rrrr,cSum);
    }
    
    [Fact]
    public void TvlDecode()
    {
        var result= new Tlv().Decode(new byte[] {0, 1, 0, 6, 1, 1});
    }
    
}